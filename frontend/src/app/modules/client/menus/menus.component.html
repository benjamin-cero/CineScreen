<div class="menus-container">
  <!-- Page Header -->
  <div class="page-header">
    <h1 class="page-title">
      <mat-icon>restaurant_menu</mat-icon>
      {{ 'MENU.TITLE' | translate }}
    </h1>
    <p class="page-subtitle">{{ 'MENU.SUBTITLE' | translate }}</p>
  </div>

  <div class="filter-section">
    <mat-card class="filter-card">
      <mat-card-content>
        <form [formGroup]="filterForm" (ngSubmit)="applyFilters()" class="filter-form">
          <div class="filter-row">
            <mat-form-field appearance="outline" class="search-field">
              <mat-label>{{ 'MENU.SEARCH' | translate }}</mat-label>
              <input matInput formControlName="search" placeholder="{{ 'MENU.SEARCH_PLACEHOLDER' | translate }}">
              <mat-icon matSuffix>search</mat-icon>
            </mat-form-field>
            <button mat-raised-button color="primary" type="submit">
              <mat-icon>filter_list</mat-icon>
              {{ 'MENU.APPLY_FILTERS' | translate }}
            </button>
            <button mat-button type="button" (click)="clearFilters()">
              <mat-icon>clear</mat-icon>
              {{ 'MENU.CLEAR' | translate }}
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="60"></mat-spinner>
    <p>{{ 'MENU.LOADING' | translate }}</p>
  </div>

  <div *ngIf="!loading" class="menu-content">
    <div class="menu-grid">
      <mat-card *ngFor="let item of menuItems" class="menu-card" [id]="'menu-item-' + item.id">
        <div class="menu-header">
          <div class="menu-image">
            <img [src]="getMenuImage(item.image)" [alt]="item.name" (error)="onImageError($event)">
          </div>
          <div class="menu-info">
            <h2 class="menu-name">{{ item.name }}</h2>
            <div class="menu-price">{{ item.price | number:'1.2-2' }} KM</div>
            <div class="manufacturer-tags" *ngIf="itemManufacturers[item.id]?.length">
              <mat-chip *ngFor="let m of itemManufacturers[item.id]; let i = index"
                        class="manufacturer-chip"
                        [style.--chip-index]="i">
                <mat-icon class="manufacturer-icon">restaurant</mat-icon>
                {{ m }}
              </mat-chip>
            </div>
          </div>
        </div>

        <div class="menu-actions">
          <button
            mat-raised-button
            color="primary"
            class="reserve-btn"
            (click)="isUserLoggedIn() ? openReservation(item) : navigateToLogin()"
            [matTooltip]="!isUserLoggedIn() ? 'Prijavite se da biste mogli rezervisati' : ''"
            matTooltipPosition="above">
            <mat-icon>{{ isUserLoggedIn() ? 'add_shopping_cart' : 'lock' }}</mat-icon>
            {{ isUserLoggedIn() ? ('MENU.RESERVE' | translate) : 'Prijavite se' }}
          </button>
        </div>
      </mat-card>
    </div>
  </div>
</div>


